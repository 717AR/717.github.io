<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" href="787.png">
    <link rel="stylesheet" href="https://717AR.github.io/787.css">
    <title>787 Links</title>
</head>
    
<body>
    <div class="header">
        <div class="header-content">
            <span>787 Links</span> 
        </div>
    </div>
    
    <div class="reserve-dashboard">
        <div>
            <button class="button" id="today-button">Today RSV</button>
            <button class="button" id="tomorrow-button" style="display: none;">Tomorrow RSV</button> <br>
        </div>
    </div>
    

    <div class="selector-container">
        <label for="doc">Or Select Doc:</label>
        <select name="doc" id="doc">
             <option value="#">Select PDF</option>
            <option value="RSV">Reserve Dashboard</option>
            <option value="REC">Recalls</option>
            <option value="DFS">DFS History</option>
            <option value="VAC2024">Vacation - 2024</option>
            <option value="VAC2025">Vacation - 2025</option>
        </select>
    </div>    
And Date:
<div class="container">
  <div class="calendar">

      <pre class="left">◀</pre>
      <header>
      <div class="header-display">
        <p class="display">""</p>
      </div>

      <pre class="right">▶</pre>
    </header>

    <div class="week">
      <div>Su</div>
      <div>Mo</div>
      <div>Tu</div>
      <div>We</div>
      <div>Th</div>
      <div>Fr</div>
      <div>Sa</div>
    </div>
    <div class="days"></div>
  </div>
  <div class="display-selected">
    <p class="selected"></p>
  </div>
</div>

<script>
const pdfBaseUrl = 'https://hawaiianair.sharepoint.com/sites/flightoperations/Daily%20Flight%20Schedules/';
        
let display = document.querySelector(".display");
let days = document.querySelector(".days");
let previous = document.querySelector(".left");
let next = document.querySelector(".right");
let selected = document.querySelector(".selected");
let docSelect = document.getElementById('doc'); // Document selection dropdown

let date = new Date();
let year = date.getFullYear();
let month = date.getMonth();

function displayCalendar() {
  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const firstDayIndex = firstDay.getDay();
  const numberOfDays = lastDay.getDate();

  let formattedDate = date.toLocaleString("en-US", {
    month: "long",
    year: "numeric"
  });

  display.innerHTML = `${formattedDate}`;

  // Filling in days
  for (let x = 1; x <= firstDayIndex; x++) {
    const div = document.createElement("div");
    days.appendChild(div);
  }

  for (let i = 1; i <= numberOfDays; i++) {
    let div = document.createElement("div");
    let currentDate = new Date(year, month, i);
    div.dataset.date = currentDate.toDateString();
    div.innerHTML = i;
    days.appendChild(div);

    // Highlight the current date
    if (
      currentDate.getFullYear() === new Date().getFullYear() &&
      currentDate.getMonth() === new Date().getMonth() &&
      currentDate.getDate() === new Date().getDate()
    ) {
      div.classList.add("current-date");
    }
  }
}

// Call the function to display the calendar
displayCalendar();

// Navigate to previous month
previous.addEventListener("click", () => {
  days.innerHTML = "";
  selected.innerHTML = "";

  if (month <= 0) {
    month = 11;
    year -= 1;
  }

  month -= 1;

  date.setMonth(month);
  displayCalendar();
});

// Navigate to next month
next.addEventListener("click", () => {
  days.innerHTML = "";
  selected.innerHTML = "";

  if (month >= 11) {
    month = 0;
    year += 1;
  }

  month += 1;
  date.setMonth(month);

  displayCalendar();
});

// Store selected document globally
let selectedDocument = "";

// Event listener for document selection
docSelect.addEventListener('change', function() {
    selectedDocument = this.value; // Store selected document
});

// Function to get formatted date for URL
function getFormattedDateForUrl(date) {
    const days = String(date.getDate()).padStart(2, '0');
    const month = date.toLocaleString('default', { month: 'short' }).toUpperCase();
    const year = String(date.getFullYear()).slice(-2);
    return `${days}${month}${year}`;
}

// Function to display selected date and open the appropriate PDF
function displaySelected() {
    const dayElements = document.querySelectorAll(".days div");
    dayElements.forEach((day) => {
        day.addEventListener("click", (e) => {
            const selectedDate = e.target.dataset.date;
            selected.innerHTML = `Selected Date: ${selectedDate}`;

            // Determine which URL to open based on the selected document
            if (selectedDocument === "RSV" || selectedDocument === "REC" || selectedDocument === "DFS") {
                const urlMap = {
                    "RSV": `${getFormattedDateForUrl(new Date(selectedDate))}-PI%20PAX%20RSV%20LIST.PDF`,
                    "REC": `${getFormattedDateForUrl(new Date(selectedDate))}-PI%20RCL%20LIST.PDF`,
                    "DFS": `${getFormattedDateForUrl(new Date(selectedDate))}-787%20DFSH.PDF`
                };

                const pdfUrl = pdfBaseUrl + urlMap[selectedDocument];
                window.open(pdfUrl, '_blank');
                
            } else if (selectedDocument === "VAC2024") {
                // Open the specific link for Vacation - 2024
                window.open("https://hawaiianair.sharepoint.com/sites/flightoperations/CrewPlanning/Vacation/2024%20Vacation%20Availability/787ca2024.pdf", '_blank');
                docSelect.selectedIndex = 0; // Reset selection to the first option
                
            } else if (selectedDocument === "VAC2025") {
                // Open the specific link for Vacation - 2025
                window.open("https://hawaiianair.sharepoint.com/sites/flightoperations/CrewPlanning/Vacation/2025%20Annual%20Vacation%20Bidding/787ca2025.pdf", '_blank');
                docSelect.selectedIndex = 0; // Reset selection to the first option
            }
        });
    });
}

// Initialize the displaySelected functionality
displaySelected();

// Function to display today's or tomorrow's PDF based on button clicks
function displayDate() {
    const today = new Date();
    const hawaiiTime = new Date(today.toLocaleString("en-US", { timeZone: "Pacific/Honolulu" }));
    const isAfter1600HST = hawaiiTime.getHours() >= 16;      
    const tomorrowButton = document.getElementById('tomorrow-button');

    if (isAfter1600HST) {
        tomorrowButton.style.display = 'block';
        tomorrowButton.onclick = function() {
            const tomorrowDate = new Date();
            tomorrowDate.setDate(today.getDate() + 1);
            const pdfUrl = `${pdfBaseUrl}${getFormattedDateForUrl(tomorrowDate)}-PI%20PAX%20RSV%20LIST.PDF`;
            window.open(pdfUrl, '_blank');
        };
    }

    document.getElementById('today-button').onclick = function() {
        const pdfUrl = `${pdfBaseUrl}${getFormattedDateForUrl(today)}-PI%20PAX%20RSV%20LIST.PDF`;
        window.open(pdfUrl, '_blank');
    };
}

// Call the displayDate function
displayDate();
    
</script>
</body>
</html>
