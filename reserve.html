<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="787.png">
    <link rel="stylesheet" href="https://717AR.github.io/787.css">
    <title>787 Links</title>
</head>

<body>
    <div class="header">
        <div class="header-content">
            <span>787 Links</span> 
        </div>
    </div>
 <br>
    <div class="reserve-dashboard">
        <div>
            <button class="button" id="today-button">Today RSV</button>
            <button class="button" id="tomorrow-button" style="display: none;">Tomorrow RSV</button>
        </div>
    </div>
        
        <div class="selector-container">
          <label for="doc">More Stuff:</label>
            <select name="doc" id="doc">
                <option value="#">Select PDF Then Date</option>
                <option value="RSV">Reserve Dashboard</option>
                <option value="REC">Recalls</option>
                <option value="DFS">DFS History</option>
            </select>
        <br>
        <input type="date" id="datepicker">
    </div>

    <div class="go-button-container">
        <button class="button disabled" id="go-button" disabled>Go</button>
    </div>
    
    <div class="vacation-dot">
        <a href="https://hawaiianair.sharepoint.com/sites/flightoperations/CrewPlanning/Vacation/2025%20Annual%20Vacation%20Bidding/787ca2025.pdf" target="_blank"></a>
    </div>
    <script>
         // Function to get today's date in the correct format DDMMMYY
        function getFormattedDate(date) {
            const days = String(date.getDate()).padStart(2, '0');  // Get day of month
            const month = date.toLocaleString('default', { month: 'short' }).toUpperCase(); // Get month name in uppercase
            const year = String(date.getFullYear()).slice(-2); // Get last two digits of the year          
            return `${days}${month}${year}`; // Format as DDMMMYY
        }

        // Function to check if the current time is past 4:00 PM Hawaii time
        function isAfterFourPMHawaii() {
            const hawaiiTime = new Intl.DateTimeFormat('en-US', {
                timeZone: 'Pacific/Honolulu', // Hawaii time zone
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false // 24-hour format to make comparison easier
            }).format(new Date());

            const [hours, minutes] = hawaiiTime.split(':').map(Number);
            return (hours > 16) || (hours === 16 && minutes >= 0);
        }

        // Function to display the PDF link
        function displayPDFLink() {
            const today = new Date();
            const tomorrow = new Date();
            tomorrow.setDate(today.getDate() + 1); // Increment date by 1 for tomorrow

            const formattedToday = getFormattedDate(today); // For today
            const formattedTomorrow = getFormattedDate(tomorrow); // For tomorrow

            const pdfUrlToday = `https://hawaiianair.sharepoint.com/sites/flightoperations/Daily%20Flight%20Schedules/${formattedToday}-PI PAX RSV LIST.PDF`;
            const pdfUrlTomorrow = `https://hawaiianair.sharepoint.com/sites/flightoperations/Daily%20Flight%20Schedules/${formattedTomorrow}-PI PAX RSV LIST.PDF`;

            const pdfContainer = document.getElementById('tomorrow-button');
            const tomorrowVisible = isAfterFourPMHawaii();
        }

        const docSelect = document.getElementById('doc');
        const datePicker = document.getElementById('datepicker');
        const goButton = document.getElementById('go-button');

        docSelect.addEventListener('change', function() {
            const selectedDoc = this.value;
            datePicker.style.display = 'inline';

            goButton.disabled = true;
            goButton.classList.add('disabled');
            goButton.classList.remove('enabled');

            if (selectedDoc !== "#" && datePicker.value) {
                goButton.disabled = false;
                goButton.classList.add('enabled');
                goButton.classList.remove('disabled');
            }
        });

        datePicker.addEventListener('change', function() {
            const selectedDoc = docSelect.value;
            const selectedDate = new Date(this.value); 
            const hawaiiDate = new Date(selectedDate.toLocaleString("en-US", { timeZone: "Pacific/Honolulu" }));
            const formattedDate = getFormattedDateForUrl(hawaiiDate);

            goButton.disabled = !(selectedDoc !== "#" && datePicker.value);
            goButton.classList.toggle('enabled', !goButton.disabled);
            goButton.classList.toggle('disabled', goButton.disabled);
        });

        goButton.addEventListener('click', function() {
            const selectedDoc = docSelect.value;
            const selectedDate = new Date(datePicker.value);
            const hawaiiDate = new Date(selectedDate.toLocaleString("en-US", { timeZone: "Pacific/Honolulu" }));
            let pdfUrl = '';
            const formattedDate = getFormattedDateForUrl(hawaiiDate);

            if (selectedDoc === "RSV") {
                pdfUrl = `${pdfBaseUrl}${formattedDate}-PI PAX RSV LIST.PDF`;
            } else if (selectedDoc === "REC") {
                pdfUrl = `${pdfBaseUrl}${formattedDate}-PI RCL LIST.PDF`;
            } else if (selectedDoc === "DFS") {
                pdfUrl = `${pdfBaseUrl}${formattedDate}-787 DFSH.PDF`;
            }

            if (pdfUrl) {
                window.open(pdfUrl, '_blank');
            }
        });

        displayDate();
    </script>
</body>
</html>
