<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" href="787.png">
    <link rel="stylesheet" href="https://717AR.github.io/787.css">
    <title>787 Links</title>
</head>
    
<body>
    <div class="top">
        <div class="top-content">
            <span>787 Links</span>
                1500 test  
        </div>
    </div>
    
    <div class="reserve-dashboard">
        <div>
            <button class="button" id="today-button">Today RSV</button>
            <button class="button" id="tomorrow-button" style="display: none;">Tomorrow RSV</button> <br>
        </div>
    </div>

    <div class="selector-container">
        <label for="doc">More Links:</label>
        <select name="doc" id="doc">
             <option value="#">Select PDF</option>
            <option value="RSV">Reserve Dashboard</option>
            <option value="REC">Recalls</option>
            <option value="DFS">DFS History</option>
            <option value="VAC2024">Vacation - 2024</option>
            <option value="VAC2025">Vacation - 2025</option>
        </select>
    </div>    

<div class="container">
  <div class="calendar">
    <header>
      <pre class="left">◀</pre>
      
      <div class="header-display">
        <p class="display">""</p>
      </div>

      <pre class="right">▶</pre>
    </header>

    <div class="week">
      <div>Su</div>
      <div>Mo</div>
      <div>Tu</div>
      <div>We</div>
      <div>Th</div>
      <div>Fr</div>
      <div>Sa</div>
    </div>
    <div class="days"></div>
  </div>
  <div class="display-selected">
    <p class="selected"></p>
  </div>
</div>

    <script>
        const pdfBaseUrl = 'https://hawaiianair.sharepoint.com/sites/flightoperations/Daily%20Flight%20Schedules/';
        
        function getFormattedDateForUrl(date) {
            const days = String(date.getDate()).padStart(2, '0');
            const month = date.toLocaleString('default', { month: 'short' }).toUpperCase();
            const year = String(date.getFullYear()).slice(-2);
            return `${days}${month}${year}`;
        }

        function displayDate() {
            const today = new Date();
            const hawaiiTime = new Date(today.toLocaleString("en-US", { timeZone: "Pacific/Honolulu" }));
            const isAfter1600HST = hawaiiTime.getHours() >= 16;

            const tomorrowButton = document.getElementById('tomorrow-button');
            if (isAfter1600HST) {
                tomorrowButton.style.display = 'block';
                tomorrowButton.onclick = function() {
                    const tomorrowDate = new Date();
                    tomorrowDate.setDate(today.getDate() + 1);
                    const pdfUrl = `${pdfBaseUrl}${getFormattedDateForUrl(tomorrowDate)}-PI PAX RSV LIST.PDF`;
                    window.open(pdfUrl, '_blank');
                };
            }

            document.getElementById('today-button').onclick = function() {
                const pdfUrl = `${pdfBaseUrl}${getFormattedDateForUrl(today)}-PI PAX RSV LIST.PDF`;
                window.open(pdfUrl, '_blank');
            };
        }

const docSelect = document.getElementById('doc');
const datePicker = document.getElementById('datepicker');

docSelect.addEventListener('change', function() {
    const selectedDoc = this.value;
        
    } else if (selectedDoc === "VAC2024") {
        // Open the specific link for Vacation - 2024 immediately
        window.open("https://hawaiianair.sharepoint.com/sites/flightoperations/CrewPlanning/Vacation/2024%20Vacation%20Availability/787ca2024.pdf", '_blank');
        this.selectedIndex = 0; // Reset to the first option
    } else if (selectedDoc === "VAC2025") {
        // Open the specific link for Vacation - 2025 immediately
        window.open("https://hawaiianair.sharepoint.com/sites/flightoperations/CrewPlanning/Vacation/2025%20Annual%20Vacation%20Bidding/787ca2025.pdf", '_blank');
        this.selectedIndex = 0; // Reset to the first option
    }
});


datePicker.addEventListener('change', function() {
    const selectedDoc = docSelect.value;
    const selectedDate = new Date(this.value); // Value should be in local time

    // Check if the selected date is valid
    if (!isNaN(selectedDate.getTime())) {
        const hawaiiDate = new Date(selectedDate.toString());
        hawaiiDate.setHours(hawaiiDate.getHours() + 20); // Adjust to Hawaii time

        console.log(`selected date: ${selectedDate}`);

        // Format the date for URL
        let pdfUrl = '';
        const formattedDate = getFormattedDateForUrl(hawaiiDate);

        if (selectedDoc === "RSV") {
            pdfUrl = `${pdfBaseUrl}${formattedDate}-PI PAX RSV LIST.PDF`;
        } else if (selectedDoc === "REC") {
            pdfUrl = `${pdfBaseUrl}${formattedDate}-PI RCL LIST.PDF`;
        } else if (selectedDoc === "DFS") {
            pdfUrl = `${pdfBaseUrl}${formattedDate}-787 DFSH.PDF`;
        }

         console.log(`Hawaii date (adjusted): ${hawaiiDate}`);

        // Open the corresponding PDF
        if (pdfUrl) {
            window.open(pdfUrl, '_blank');
            // Clear the selection after opening
            docSelect.selectedIndex = 0;
            datePicker.style.display = 'none'; // Hide the date picker again
        }
    }
});
        displayDate();

        let display = document.querySelector(".display");
let days = document.querySelector(".days");
let previous = document.querySelector(".left");
let next = document.querySelector(".right");
let selected = document.querySelector(".selected");

let date = new Date();

let year = date.getFullYear();
let month = date.getMonth();

function displayCalendar() {
  const firstDay = new Date(year, month, 1);

  const lastDay = new Date(year, month + 1, 0);

  const firstDayIndex = firstDay.getDay(); //4

  const numberOfDays = lastDay.getDate(); //31

  let formattedDate = date.toLocaleString("en-US", {
    month: "long",
    year: "numeric"
  });

  display.innerHTML = `${formattedDate}`;

  for (let x = 1; x <= firstDayIndex; x++) {
    const div = document.createElement("div");
    div.innerHTML += "";

    days.appendChild(div);
  }

  for (let i = 1; i <= numberOfDays; i++) {
    let div = document.createElement("div");
    let currentDate = new Date(year, month, i);

    div.dataset.date = currentDate.toDateString();

    div.innerHTML += i;
    days.appendChild(div);
    if (
      currentDate.getFullYear() === new Date().getFullYear() &&
      currentDate.getMonth() === new Date().getMonth() &&
      currentDate.getDate() === new Date().getDate()
    ) {
      div.classList.add("current-date");
    }
  }
}

// Call the function to display the calendar
displayCalendar();

previous.addEventListener("click", () => {
  days.innerHTML = "";
  selected.innerHTML = "";

  if (month < 0) {
    month = 11;
    year = year - 1;
  }

  month = month - 1;

  date.setMonth(month);

  displayCalendar();
  displaySelected();
});

next.addEventListener("click", () => {
  days.innerHTML = "";
  selected.innerHTML = "";

  if (month > 11) {
    month = 0;
    year = year + 1;
  }

  month = month + 1;
  date.setMonth(month);


  displayCalendar();
  displaySelected();
});

function displaySelected() {
  const dayElements = document.querySelectorAll(".days div");
  dayElements.forEach((day) => {
    day.addEventListener("click", (e) => {
      const selectedDate = e.target.dataset.date;
      selected.innerHTML = `Selected Date : ${selectedDate}`;
    });
  });
}
displaySelected();
    </script>
</body>
</html>
